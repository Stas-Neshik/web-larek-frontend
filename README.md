# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей (поправил)
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```










## Данные и типы данных, используемые в приложении


















## Архитектура приложения.

Код приложения разделен на слои в парадигме MPV. 
1. Слой данных Modal (работа с данными).
2. Слой представления View (отображение, работа с версткой).
3. Слой презентер (связывающее звено).



### Базовые компоненты. 

#### Класс API.

Класс API предоставляет базовую логику работы с запросами. Он позволяет выполнять `GET` и `POST`, `DELETE` запросы к серверу.
Конструктор принимает 2 аргумента - адресс сервера, заголовки запроса (headers).

Методы класса - 

`GET` - Выполняет GET запрос к указанному URL. Возвращает ответ от сервера в виде объекта.\
`POST` - Выполняет запрос в зависимости от переданного method. принимает на вход индпоинт, данные, вид запроса.\
`handleResponse` - обрабатывает ответ с сервера и ошибки.\ 

#### Класс EventEmitter.

Класс представляет собой брокер событий, который позволяет отправлять и получать события между различными частями приложения. Это классическая реализация брокера событий, которая широко используется в разработке программного обеспечения.

Методы класса - 

`on` - Регистрирует функцию обратного вызова (callback) для обработки события (event). Функция обратного вызова будет вызываться каждый раз, когда происходит событие.\
`off` - Удаляет функцию обратного вызова (callback) из списка обработчиков события (event). Если функция обратного вызова не найдена, метод ничего не делает.\
`trigger` - Генерирует событие (event) с заданным контекстом (context). Контекст может быть использован для передачи дополнительной информации обработчикам события.\
`emit` - инициирует событие с данными.\
`OnAll` - устанавливает обработчик на все события.\
`OffAll` - снимает обработчик на все события.\

#### Класс Component.

Является основой для других классов в проекте. Реализует общие возможности работы с разметкой на странице.

Методы класса - 

`setText` - устанаилвает текстовое содержимое на элемент.
`setImage` - устанаилвает адрес картинки, альт содержимое. 
`render` - выполняет рендеринг элемента страницы.
`toggle` - переключает класс у элемента.
`setDisabled` - делает элемент неактивным.
`setHiddet` - делает элемент скрытым.
`setVisible` - делает элемент видимым.

#### Класс Model.

Класс предназначен для модельных данных. 

Метод класса - 

`emitChanges` - сообщает об изменении данных, получает событие и данные, связанные с изменением.


### Слой данных (Modal).


#### Class AppData.
Наследуется от класса Model.
Класс хранит данные приложения и события. 
Используется как главный контейнер с информацией.

В полях класса хранятся следующие данные - 

- `items: IItem[]` - массив обьектов о товаре.
- `basket: []` - массив содержащий ID товаров в корзине.
- `order: Iorder` - хранит заказ.
- `formErrors: FormErrors` - ошибки валидации.

Методы класса - 

- `setCatalog: void` - Добавить карточки в items.
- `addItemOrder` - Добавить ID карточки в заказ.
- `removeItemOrder` - Удалить ID карточки.
- `addToBusket` - Добавить товар в корзину.
- `removeInBusket` - Удалить товар из корзину.
- `getTotalPrice` - Стоимость товаров в корзине.
- `validateOrder(): void` — Валидация формы заказа.
- `validateContacts(): void` — Валидация формы контактов.
- `clearBasket()` - Очистить корзину. 
- `isBasketEmpty(): boolean` - Проверка на наличие товара в корзине.
- `setOrderField(field: keyof IContactsForm, value: string): void` — сохранить данные заказа.
- `setContactsField(field: keyof IDeliveryForm, value: string): void` — сохранить данные контактов.


### Слой представления (View).
Классы представления отвечают за отображения внутри контейнера передаваемых данных.


### Класс Page
Наследуется от класса Component.

Компонент главной страницы. Добавляет на страницу карточки. вешает слушатель на элемент корзины. Изменяет количество элементов корзины. 

В полях класса хранятся следующие данные - 

- `_catalog: HTMLElement` — контейнер для отображения карточек.
- `_basket: HTMLElement` —  элемент корзины.
- `_counter: HTMLElement` — элемент счетчика корзины.

Методы класса - 

- `set catalog(items: HTMLElement[])` — добавляет карточки на страницу. 
- `set counter(value: number)` — устанаивливает количество элементов в корзине. 


#### Class Card.
Наследуется от класса Component.

Отвечает за отображение карточки. Хранит в себе HTML разметку карточки.
В конструктор передается DOM-элемент `template` карточки, `EventEmitter` и обьект данных о товаре типа IItem[]. 

В полях класса хранятся следующие данные - 

  - `_category: HTMLElement` - элемент категории.
  - `_title: HTMLElement` - элемент заголовка.
  - `_image: HTMLImageElement` - элемент картинки.
  - `_price: HTMLElement` - элемент стоимости. 
  - `_categoryColors` - классы цвета. 

Методы класса - 

 - ` set category(value: string)` - устанавливает название категории.
 - ` set title(value: string)` - устанавливает название карточки.
 - ` set image(value: string)` - устанавливает картинку.
 - ` set price(value: string)` - устанавливает цену.


#### Class CardPreview.
Наследуется от класса Card.

В полях класса хранятся следующие данные - 

- `_description: HTMLElement` — описание единицы товара.
- `buttonElement: HTMLButtonElement` — элемент кнопки.

Методы класса - 

- `set description(value: string)` — устанавливает описание карточки.
- `changeBasketName(value: string)` — изменяет состояние кнопки.

#### Class BusketItem.
Наследуется от класса Card.

Карточка товара в модальном окне корзины.

В полях класса хранятся следующие данные - 

- `_buttonElement: HTMLButtonElement` — элемент кнопки.
- `_index: HTMLElement` — номер товара.

Методы класса - 

- `set index(value: number)` — устанавливает номер товара.

### Класс ApiData.
Наследуется от класса API.

Делает запрос на сервер для получения массива данных карточек. 

В полях класса хранятся следующие данные - 

- `cdn: string` — адрес CDN для картинки. 

Методы класса - 

- `getData` — создает массив состоящий из обьектов карточки с полной ссылкой на картинку.


### Класс Modal.
Наследуется от класса Component.
Отображение модального окна. 

В полях класса хранятся следующие данные - 

- `_content: HTMLElement` — контент модального окна.
- `_closeButton: HTMLButtonElement` — элемент кнопки закрытия.

Методы класса - 

- `open(): void` — открывает окно.
- `close(): void` — закрывает окно.
- `set content(value: HTMLElement)` — заполняет окно контентом.
- `render(data: IModalData): HTMLElement` — создает разметку.


### Класс ModalBasket.
Наследуется от класса Component.
Модальное окно корзины. Устанавливает разметку и цену.

В полях класса хранятся следующие данные - 

- `_list: HTMLElement[]` — массив элементов в корзине.
- `totalPrice: HTMLElement` — элемент с финальной ценой.
- `buttonElement: HTMLButtonElement` — элемент кнопки.

Методы класса - 

- `set _list(items: HTMLElement[])` — добавляет список элементов корзины.
- `set total(total: number)` — устанавливает общую стоимость.


### Класс Form
Наследуется от класса Component.
Представляет функционал для форм заказа.

В полях класса хранятся следующие данные - 

- `submit: HTMLButtonElement` — кнопка далее.
- `_errors: HTMLElement` — элемент для отображения ошибки.

Методы класса - 

- `onInputChange(field: keyof T, value: string)` — валидация поля
- `set valid(value: boolean)` — отвечает за состояние кнопки. 
- `set errors(value: string)` — установка ошибки. 
- `render(data: <T>): HTMLFormElement` — заполняет контентом модальное окно.


### Класс Order.
Наследуется от класса Form.
Представляет функционал модального окна заказа. 

В полях класса хранятся следующие данные - 

- `paymentButtons: HTMLButtonElement[]` — кнопки выбора оплаты.

Методы класса - 

- `set payment(name: string)` — устанавливает выбранный способ оплаты.
- `set address(value: string)` — устанавливает адрес доставки.

### Класс Contacts.
Наследуется от класса Form.
Представляет функционал модального окна контактов. 

Методы класса - 

- `set email(name: string)` — для добавления почты .
- `set address(value: string)` — для добавления телефона.

### Класс Success.
Наследуется от класса Component.
Финальное модальное окно об успешном оформлении заказа. 

В полях класса хранятся следующие данные - 

- `close: HTMLElement` — кнопка закрытия окна
- `_totalPrice: HTMLElement` — списанное количество денег

Методы класса - 

- `set totalPrice(total: number | string)` — устанавливает размер заказа. 



## Взаимодействие компонентов.

Код, описывающий взаимодействие представления и данных находится в `index.ts`.
Взаимодействие осуществляется за счет событий генерирумых в `index.ts` и брокера событий `EventEmitter`.

Список событий, которые могут генерироваться в системе.

`items:changed` - Событие изменения каталога товаров. Запускает рендерринг карточек на главную страницу.
`basket:open` - Событие открытия модального окна корзины 
`modal:open` - Событие открытия модального окна, заморозка состояния.
`modal:close` - Событие закрытия модального окна.
`order:open` - Событие открытия модального окна оформления заказа 
`formErrors:change` - Событие запуска валидации полей заказа. 
`payment:change` - событие изменение способа оплаты.
`items:test`
`order:submit` - Событие сабмита заказа.
`card:remove` - Событие очистки корзины.